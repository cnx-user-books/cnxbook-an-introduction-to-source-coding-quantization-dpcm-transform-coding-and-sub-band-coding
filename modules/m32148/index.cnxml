<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:md="http://cnx.rice.edu/mdml">

<title>MPEG Layers 1-3: Cosine-Modulated Filterbanks</title>
<metadata>
  <md:content-id>m32148</md:content-id><md:title>MPEG Layers 1-3: Cosine-Modulated Filterbanks</md:title>
  <md:abstract>Here the "polyphase quadrature" filterbank used in the MPEG audio standards is described in great detail.  It has the following practical features: real-valued sub-band outputs, near-perfect reconstruction, and polyphase implementation; and is based on cancellation of adjacent sub-band interference.</md:abstract>
  <md:uuid>268ee474-93b3-4a5f-9813-c9e2e0b374ae</md:uuid>
</metadata>

<content>
      
        <list id="id2682441" display="block" list-type="bulleted"><item id="uid48">Though the uniformly modulated filterbank in <link document="m32143" target-id="uid40">Figure 4 from "Uniformly-Modulated Filterbanks"</link>
was shown to have the fast implementation in <link document="m32143" target-id="uid45">Figure 5 from "Uniformly-Modulated Filterbanks"</link>,
the sub-band outputs are complex-valued for real-valued
input, hence inconvenient (at first glance<footnote id="uid49">In the structure in <link document="m32143" target-id="uid40">Figure 4 from "Uniformly-Modulated Filterbanks"</link>, it would be reasonable
to replace the standard DFT with a real-valued DFT (defined in
the notes on transform coding), requiring <m:math overflow="scroll"><m:mrow><m:mo>≈</m:mo><m:mi>N</m:mi><m:msub><m:mo form="prefix">log</m:mo><m:mn>2</m:mn></m:msub><m:mi>N</m:mi></m:mrow></m:math>
real-multiplies when <emphasis effect="italics">N</emphasis> is a power of 2.
Though it is not clear to the author why such a structure was not
adopted in the MPEG standards, the cosine modulated filterbank
derived in this section has equivalent performance and, with
its polyphase/DCT implementation, equivalent implementation cost.</footnote>) for sub-band coding of real-valued data.
In this section we propose a closely related filterbank with the
following properties.
<list id="id2682525" display="block" list-type="enumerated"><item id="uid50">Real-valued sub-band outputs (assuming real-valued inputs),
</item><item id="uid51">Near-perfect reconstruction,
</item><item id="uid52">Polyphase/fast-transform implementation.
</item></list>
This turns out to be the filterbank specified in the MPEG-1 and 2
(layers 1-3) audio compression standards (see IS0/IEC 13818-3).
</item>
        </list>
        <section id="uid53">
          <title>Filter Design</title>
          <list id="id2682587" display="block" list-type="bulleted"><item id="uid54"><emphasis effect="italics"><emphasis effect="underline">Real-valued Sub-band Outputs:</emphasis></emphasis> 
Recall the generic filterbank structure of <link document="32143" target-id="uid34">Figure 1 from "Uniformly-Modulated Filterbanks"</link>.
For the sub-band outputs to be real-valued (for real-valued input),
we require that the impulse responses of <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>
are real-valued.
We can insure this by allocating the <emphasis effect="italics">N</emphasis> (symmetric) frequency band pairs
shown in <link target-id="uid55"/>.
The positive and negative halves of each band pair are centered at
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>ω</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:mi>π</m:mi></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac></m:mrow></m:math> radians.
<figure id="uid55"><media id="uid55_media" alt="This figure is a cartesian graph, with horizontal axis ω, and an unlabeled vertical axis. The graph consists of eight colored, connected rectangles of identical dimension, beginning. The rectangles all have one side drawn on the base of the graph. The leftmost rectangle's left side is located at a ω-value of -π, and the rightmost rectangles right side is located at a ω-value of π. The midpoint along the horizontal axis of each rectangle is labeled from left to right as -ω_3, -ω_2, -ω_1, -ω_0, ω_0, ω_1, ω_2, and ω_3. The rectangles from left to right are colored green, red, blue, grey, grey, blue, red, green. Above the left side of the graph is a horizontal arrow pointing in both directions, labeled π/N. Above the right side of the graph is the equation ω_i = [(2i + 1)π]/2N."><image mime-type="image/png" src="../../media/img033.png" id="uid55_onlineimage" width="468"><!-- NOTE: attribute width changes image size online (pixels). original width is 468. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img033.eps" id="uid55_printimage"/></media><caption>Frequency band pairs for the polyphase quadrature filterbank (<m:math overflow="scroll"><m:mrow><m:mi>N</m:mi><m:mo>=</m:mo><m:mn>4</m:mn></m:mrow></m:math>).</caption></figure>
We can consider each filter <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> as some combination of
symmetric positive-frequency and negative-frequency components
<equation id="id2682785"><m:math overflow="scroll" mode="display"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math></equation>
as shown in <link target-id="uid56"/>.
<figure id="uid56"><media id="uid56_media" alt="this figure is a graph with horizontal axis ω and vertical axis H_i(ω). The horizontal axis establishes wide boundaries of -π and π. Below the graph is a horizontal arrow pointing in both directions, labeled (2i + 1)π/N. There are two shaded trapezoids located on the graph, with their base drawn on the horizontal axis. The trapezoid on the left is labeled G_i(ω), and the midpoint of its base is labeled with a horizontal value -ω_i. The trapezoid on the right is labeled F_i(ω), and the midpoint of its base is labeled with a horizontal value ω_i. Above both trapezoids are horizontal arrows pointing in both directions, labeled π/N."><image mime-type="image/png" src="../../media/img034.png" id="uid56_onlineimage" width="482"><!-- NOTE: attribute width changes image size online (pixels). original width is 482. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img034.eps" id="uid56_printimage"/></media><caption>Positive- and negative-frequency decomposition of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. Note <m:math overflow="scroll"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> will have a similar, if not identical, frequency response.</caption></figure>
When <m:math overflow="scroll"><m:mrow><m:msub><m:mi>b</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup></m:mrow></m:math> and the pairs <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> are
modulated versions of the same prototype filter <m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math>, we can show
that <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> must be real-valued:
<equation id="uid57"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:munder><m:munder accentunder="true"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac></m:mrow></m:msup><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:munder><m:mspace width="0.222222em"/><m:mo>+</m:mo><m:mspace width="0.277778em"/><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:munder><m:munder accentunder="true"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac></m:mrow></m:msup><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:munder></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:munder><m:mo>∑</m:mo><m:mi>n</m:mi></m:munder><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:munder><m:mo>∑</m:mo><m:mi>n</m:mi></m:munder><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:munder><m:mo>∑</m:mo><m:mi>n</m:mi></m:munder><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup></m:mfenced><m:mo>+</m:mo><m:mi>j</m:mi><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:munder><m:mo>∑</m:mo><m:mi>n</m:mi></m:munder><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup><m:mo>-</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:munder><m:mo>∑</m:mo><m:mi>n</m:mi></m:munder><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>·</m:mo><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mspace width="-0.166667em"/><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced><m:mo>+</m:mo><m:mi>j</m:mi><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:munder><m:mo>∑</m:mo><m:mi>n</m:mi></m:munder><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>·</m:mo><m:mn>2</m:mn><m:mi>j</m:mi><m:mo form="prefix">sin</m:mo><m:mspace width="-0.166667em"/><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mn>2</m:mn><m:munder><m:mo>∑</m:mo><m:mi>n</m:mi></m:munder><m:mfenced separators="" open="[" close="]"><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mspace width="0.166667em"/><m:mo form="prefix">cos</m:mo><m:mspace width="-0.166667em"/><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced><m:mo>-</m:mo><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mspace width="0.166667em"/><m:mo form="prefix">sin</m:mo><m:mspace width="-0.166667em"/><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation></item>
            <item id="uid58"><emphasis effect="italics"><emphasis effect="underline">Aliasing Cancellation:</emphasis></emphasis> 
Recall again the generic filterbank in <link document="32143" target-id="uid34">Figure 1 from "Uniformly-Modulated Filterbanks"</link>.
Here we determine conditions on real-valued <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> and
<m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> which lead to near-perfect reconstruction.
It will be insightful to derive an expression for the input to the <m:math overflow="scroll"><m:msup><m:mi>i</m:mi><m:mrow><m:mi>t</m:mi><m:mi>h</m:mi></m:mrow></m:msup></m:math>
reconstruction filter, <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>.
The downsample-upsample-cascade equation <link document="m32128" target-id="uid29">Equation 14 from "Fundamentals of Multirate Signal Processing"</link> (fourth equation)
implies that
<equation id="uid59"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>Y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:msub><m:mi>X</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munder><m:munder accentunder="true"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mfenced><m:mi>X</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow><m:mo>︸</m:mo></m:munder><m:mtext>desired</m:mtext></m:munder><m:mo>+</m:mo><m:munder><m:munder accentunder="true"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>undesired</m:mtext><m:mspace width="4.pt"/><m:mtext>images</m:mtext></m:mrow></m:munder><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Thus the input to the <m:math overflow="scroll"><m:msup><m:mi>i</m:mi><m:mrow><m:mi>t</m:mi><m:mi>h</m:mi></m:mrow></m:msup></m:math> reconstruction filter is corrupted by
unwanted spectral images, and the reconstruction filter's job is the
removal of these images.
The reconstruction filter
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> will have a bandpass frequency response similar (or identical)
to that of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> illustrated in <link target-id="uid56"/>.
Due to the practical design considerations, neither <m:math overflow="scroll"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> nor
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> will be perfect bandpass filters, but we will assume that
the only significant out-of-band energy passed by these filters will
occur in the frequency range just outside of their passbands.
(Note the limited “spillover” in <link target-id="uid56"/>.)
Under these assumptions, the only undesired images in <m:math overflow="scroll"><m:mrow><m:msub><m:mi>Y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
that will not be completely attenuated by <m:math overflow="scroll"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> are the images
adjacent to <m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.
Which indices <emphasis effect="italics">p</emphasis> in <link target-id="uid59"/> (third equation) are responsible for these
<emphasis effect="italics">adjacent</emphasis> images?
<link target-id="uid59"/> (third equation) implies that index <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mi>ℓ</m:mi></m:mrow></m:math> shifts the frequency
response up by <m:math overflow="scroll"><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi><m:mi>ℓ</m:mi><m:mo>/</m:mo><m:mi>N</m:mi></m:mrow></m:math> radians.
Since the passband centers of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> are <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mi>N</m:mi></m:mrow></m:math>
radians apart, the passband of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:math>
will reside directly to the left of the passband of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> when <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mi>i</m:mi></m:mrow></m:math>.
Similarly, the passband of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:math> will
reside directly to the right of the passband of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> when <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:math>.
See <link target-id="uid60"/> for an illustration.
Using the same reasoning, the passband of
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>p</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:math> will reside directly to the right
of the passband of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> when <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mo>-</m:mo><m:mi>i</m:mi></m:mrow></m:math> and directly to the left
when <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mo>-</m:mo><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math>.
The only exceptions to this rule occur when <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>, in which case
the images to the right of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> and to the left of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> are
desired, and when <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>, in which case the images to the left of
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> and to the right of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> are desired.
<figure id="uid60"><media id="uid60_media" alt="This figure is identical to the preceding figure, except that there are now four dashed trapezoids, one on each side of each of the shaded trapezoids. The bases slightly overlap on both sides with the shaded trapezoids. The trapezoids to the left and right of G_i(z) are labeled F_i(e^(-j(2π/n)p)z), and the trapezoids to the left and right of F_i(z) are labeled G_i(e^(-j(2π/n)p)z). Above the dashed trapezoids are small captions that read from left to right, p = -(i + 1), p = -i, p = i, and p = i + 1."><image mime-type="image/png" src="../../media/img035.png" id="uid60_onlineimage" width="736"><!-- NOTE: attribute width changes image size online (pixels). original width is 736. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img035.eps" id="uid60_printimage"/></media><caption>Spectral images of <m:math overflow="scroll"><m:mrow><m:msub><m:mi>Y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> not completely attenuated by <m:math overflow="scroll"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.</caption></figure>
Based on the arguments above, we can write <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>, the output of
the <m:math overflow="scroll"><m:msup><m:mi>i</m:mi><m:mrow><m:mi>t</m:mi><m:mi>h</m:mi></m:mrow></m:msup></m:math> reconstruction filter, as follows:
<equation id="uid61"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>U</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>Y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:munder><m:munder accentunder="true"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mi>X</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mi>X</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mfenced></m:mrow><m:mo>︸</m:mo></m:munder><m:mtext>desired</m:mtext></m:munder></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd columnalign="left"><m:mrow><m:mo>+</m:mo><m:munder><m:munder accentunder="true"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>aliasing</m:mtext><m:mspace width="4.pt"/><m:mtext>from</m:mtext><m:mspace width="4.pt"/><m:mtext>inner</m:mtext><m:mspace width="4.pt"/><m:mtext>undesired</m:mtext><m:mspace width="4.pt"/><m:mtext>images</m:mtext><m:mspace width="4.pt"/><m:mtext>when</m:mtext><m:mspace width="4.pt"/><m:mrow><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:mrow></m:munder></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd columnalign="left"><m:mrow><m:mo>+</m:mo><m:munder><m:munder accentunder="true"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>aliasing</m:mtext><m:mspace width="4.pt"/><m:mtext>from</m:mtext><m:mspace width="4.pt"/><m:mtext>outer</m:mtext><m:mspace width="4.pt"/><m:mtext>undesired</m:mtext><m:mspace width="4.pt"/><m:mtext>images</m:mtext><m:mspace width="4.pt"/><m:mtext>when</m:mtext><m:mspace width="4.pt"/><m:mrow><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>2</m:mn></m:mrow></m:mrow></m:munder><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
The previous equation shows that <m:math overflow="scroll"><m:mrow><m:msub><m:mi>U</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is corrupted by the portions
of the undesired images not completely removed by the reconstruction
filter <m:math overflow="scroll"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.
In the filterbank context, this undesired behavior is referred to as
aliasing.
But notice that aliasing contributions to the signal <m:math overflow="scroll"><m:mrow><m:mi>U</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mo>∑</m:mo><m:mi>i</m:mi></m:msub><m:msub><m:mi>U</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
will vanish if the inner aliasing components in <m:math overflow="scroll"><m:mrow><m:msub><m:mi>U</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> cancel the
outer aliasing components in <m:math overflow="scroll"><m:mrow><m:msub><m:mi>U</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.
This happens when

<equation id="id2686677"><m:math overflow="scroll" mode="display"><m:mtable><m:mtr><m:mtd><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced></m:mrow></m:mtd>
</m:mtr>
<m:mtr>
<m:mtd columnalign="right"><m:mo>=</m:mo><m:mrow><m:mo>-</m:mo><m:msub><m:mi>K</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:msub><m:mi>F</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>X</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced><m:mo>.</m:mo></m:mrow></m:mtd>
</m:mtr>
</m:mtable></m:math></equation>
which occurs under satisfaction of the two conditions below.

<equation id="uid62"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>-</m:mo><m:msub><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:msub><m:mi>K</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>F</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mrow><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>-</m:mo><m:msubsup><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>K</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>G</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
We assume from this point on that the real-valued
filters <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> are constructed using modulated
versions of a lowpass prototype filter <m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math>.
(This assumption is required for the existence of a polyphase
filterbank implementation.)
<equation id="uid63"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mtable><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:msubsup><m:mi>c</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable><m:mspace width="2pt"/><m:mtext>where</m:mtext><m:mspace width="2pt"/><m:mo>{</m:mo><m:mtable><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>F</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>G</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr></m:mtable></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Then condition <link target-id="uid62"/> (upper equation) becomes

<equation id="uid64"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msubsup><m:mi>c</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>=</m:mo><m:mrow><m:mo>-</m:mo><m:msub><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:msub><m:mi>c</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>-</m:mo><m:msub><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:msubsup><m:mi>c</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Lets take a closer look at the products
<m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:math>
in the previous equation.
As illustrated in <link target-id="uid66"/>, these products equal
zero when <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mo>/</m:mo><m:mn>2</m:mn></m:mrow></m:math> since their passbands do not overlap.
Setting these products to zero in <link target-id="uid64"/> (bottom equation) yields the condition
<equation id="uid65"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mtable frame="solid"><m:mtr><m:mtd><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msubsup><m:mi>c</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:mo>=</m:mo><m:mo>-</m:mo><m:msub><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:msubsup><m:mi>c</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup><m:mtext>for</m:mtext><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mtd></m:mtr></m:mtable><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
which can also be shown to satisfy <link target-id="uid62"/> (bottom equation).
<figure id="uid66"><media id="uid66_media" alt="This figure is a cartesian graph with horizontal axis ω. There are three identical shaded trapezoids of similar shape to those trapezoids in the previous figure. Two of the trapezoids are located in the second quadrant, and the other is above the first and third trapezoids is the title H(e^(-j(π/2N)(2i + 1))z), and above the second is the title  H(e^(j(π/2N)(2i + 1))z). The midpoint of the bases of these trapezoids are measured as follows: the leftmost's horizontal position is (π/2N)(2i + 1) - 2π, the second trapezoid's midpoint is (-π/(2N))(2i - 1), and the rightmost is (π/2N)(2i + 1). Below these trapezoids are two horizontal lines with arrows pointing in either direction. The first line is labeled (2(N - i) -1)π/N, and the second is labeled (2i - 1)π/N."><image mime-type="image/png" src="../../media/img036.png" id="uid66_onlineimage" width="456"><!-- NOTE: attribute width changes image size online (pixels). original width is 456. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img036.eps" id="uid66_printimage"/></media><caption>Illustration of vanishing terms in <link target-id="uid64"/> (lower equation).</caption></figure>
Next we concern ourselves with the requirements on <emphasis effect="italics">a<sub>0</sub></emphasis> and <emphasis effect="italics">c<sub>0</sub></emphasis>.
Assuming <link target-id="uid65"/> is satisfied, we know that inner aliasing
in <m:math overflow="scroll"><m:mrow><m:msub><m:mi>U</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> cancels outer aliasing in <m:math overflow="scroll"><m:mrow><m:msub><m:mi>U</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>.
Hence, from <link target-id="uid61"/> (fourth equation) and <link target-id="uid63"/> (lower equation),
<equation id="id2688791"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mi>U</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:msub><m:mi>U</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mi>X</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>c</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd columnalign="left"><m:mrow><m:mspace width="1.em"/><m:mo>·</m:mo><m:mfenced separators="" open="[" close="]"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced><m:mi>X</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Noting that the passbands of
<m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:math> and
<m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:math> do not overlap for
<m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>≤</m:mo><m:mi>i</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>2</m:mn></m:mrow></m:math>, we have
<equation id="uid67"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mi>U</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:mo>[</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mn>0</m:mn></m:msub><m:msubsup><m:mi>c</m:mi><m:mn>0</m:mn><m:mo>*</m:mo></m:msubsup><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mn>0</m:mn><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>c</m:mi><m:mn>0</m:mn></m:msub><m:mo>)</m:mo></m:mrow><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd columnalign="left"><m:mrow><m:mspace width="1.em"/><m:mo>+</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:msubsup><m:mi>c</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>c</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd columnalign="left"><m:mrow><m:mspace width="1.em"/><m:mo>+</m:mo><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:msup><m:mi>H</m:mi><m:mn>2</m:mn></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msubsup><m:mi>c</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msup><m:mi>H</m:mi><m:mn>2</m:mn></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced><m:mo>]</m:mo><m:mi>X</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
The first two terms in <link target-id="uid67"/> (third equation) represent aliasing components that
prevent flat overall response at <m:math overflow="scroll"><m:mrow><m:mi>ω</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mi>ω</m:mi><m:mo>=</m:mo><m:mi>π</m:mi></m:mrow></m:math>, respectively.
These aliasing terms vanish when
<equation id="uid68"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mtable frame="solid"><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>a</m:mi><m:mn>0</m:mn></m:msub><m:msubsup><m:mi>c</m:mi><m:mn>0</m:mn><m:mo>*</m:mo></m:msubsup></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>-</m:mo><m:msubsup><m:mi>a</m:mi><m:mn>0</m:mn><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>c</m:mi><m:mn>0</m:mn></m:msub></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>a</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:msubsup><m:mi>c</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>-</m:mo><m:msubsup><m:mi>a</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mo>*</m:mo></m:msubsup><m:msub><m:mi>c</m:mi><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:math></equation>
What remains is
<equation id="id2690094"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mi>U</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:msup><m:mi>H</m:mi><m:mn>2</m:mn></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msubsup><m:mi>c</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msup><m:mi>H</m:mi><m:mn>2</m:mn></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mfenced><m:mi>X</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation></item>
            <item id="uid69"><emphasis effect="italics"><emphasis effect="underline">Phase Distortion:</emphasis></emphasis> 
Perfect reconstruction requires that the analysis/synthesis system has
no phase distortion.
To guarantee the absence of phase distortion, we require that the
composite system
<equation id="uid70"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mi>Q</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>:</m:mo><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mfrac><m:mrow><m:mi>U</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mi>X</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mfrac><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mfrac><m:mn>1</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:msup><m:mi>H</m:mi><m:mn>2</m:mn></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msubsup><m:mi>c</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msup><m:mi>H</m:mi><m:mn>2</m:mn></m:msup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
has a linear phase response.
(Recall that a linear phase response is equivalent to a pure delay
in the time domain.)
This linear-phase constraint will provide the final condition used to
specify the constants <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math>.
We start by examining the impulse response of <m:math overflow="scroll"><m:mrow><m:mi>Q</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math>.
Using a technique analogous to <link target-id="uid57"/> (fifth equation), we can write
<equation id="id2690655"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mi>Q</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mfrac><m:mn>2</m:mn><m:mi>N</m:mi></m:mfrac><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>2</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="(" close=")"><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced><m:mo>-</m:mo><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced></m:mfenced><m:mfenced separators="" open="(" close=")"><m:munder><m:mo>∑</m:mo><m:mi>k</m:mi></m:munder><m:msub><m:mi>h</m:mi><m:mi>k</m:mi></m:msub><m:msub><m:mi>h</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mi>k</m:mi></m:mrow></m:msub></m:mfenced><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Above, we have used the property that multiplication in the <emphasis effect="italics">z</emphasis>-domain
implies convolution in the time domain.
For <m:math overflow="scroll"><m:mrow><m:mi>Q</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math> to be linear phase, it's impulse response must be symmetric.
Let us assume that the prototype filter <m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math> is linear phase, so that
<m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math> is symmetric.
Thus <m:math overflow="scroll"><m:mrow><m:msub><m:mo>∑</m:mo><m:mi>k</m:mi></m:msub><m:msub><m:mi>h</m:mi><m:mi>m</m:mi></m:msub><m:msub><m:mi>h</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mi>k</m:mi></m:mrow></m:msub></m:mrow></m:math> is symmetric about <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>,
and thus for linear phase <m:math overflow="scroll"><m:mrow><m:mi>Q</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math>, we require that the quantity
<equation id="id2691071"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced><m:mo>-</m:mo><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
is symmetric about <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>, i.e.,

<equation id="id2691269"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mfenced><m:mo>-</m:mo><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd><m:mo>=</m:mo><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>-</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mfenced><m:mo>-</m:mo><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>-</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mfenced></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
for <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>.
Using trigonometric identities, it can be shown that the condition above
is equivalent to
<equation id="id2691684"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mn>0</m:mn></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced><m:mfenced separators="" open="[" close="]"><m:mi> Re </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mfenced><m:mo>+</m:mo><m:mi> Im </m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mfenced></m:mfenced><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
which is satisfied when
<equation id="id2691933"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mfrac><m:mrow><m:mi> Im </m:mi><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mi> Re </m:mi><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:mfrac></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mo>-</m:mo><m:mfrac><m:mrow><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mfenced></m:mrow><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mfenced></m:mrow></m:mfrac><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mo form="prefix">tan</m:mo><m:mfenced separators="" open="(" close=")"><m:mo>-</m:mo><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mspace width="-0.166667em"/><m:mo>+</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mfenced><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Restricting <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>|</m:mo></m:mrow><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>|</m:mo><m:mo>=</m:mo><m:mo>|</m:mo></m:mrow><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>|</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:mrow></m:math>, the previous equation requires that
<equation id="uid71"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mtable frame="solid"><m:mtr><m:mtd><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup></m:mtd></m:mtr></m:mtable><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
It can be easily verified that the following <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math>
satisfy conditions <link target-id="uid65"/>, <link target-id="uid68"/>, and
<link target-id="uid71"/>:
<equation id="uid72"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mtable frame="solid"><m:mtr><m:mtd><m:mtable><m:mtr><m:mtd columnalign="right"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mi>M</m:mi><m:mo>+</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>4</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:msub><m:mi>c</m:mi><m:mi>i</m:mi></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mi>M</m:mi><m:mo>-</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>4</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:mtd></m:mtr></m:mtable></m:math></equation>
Plugging these into the expression for <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> we find that
<equation id="uid73"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:mi>H</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac></m:mrow></m:msup><m:mi>z</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>a</m:mi><m:mi>i</m:mi></m:msub><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup><m:mo>+</m:mo><m:msubsup><m:mi>a</m:mi><m:mi>i</m:mi><m:mo>*</m:mo></m:msubsup><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mrow></m:msup></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>-</m:mo><m:mfrac><m:mrow><m:mi>M</m:mi><m:mo>+</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mn>2</m:mn></m:mfrac><m:mo>)</m:mo></m:mrow></m:mrow></m:msup><m:mo>+</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>j</m:mi><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>-</m:mo><m:mfrac><m:mrow><m:mi>M</m:mi><m:mo>+</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mn>2</m:mn></m:mfrac><m:mo>)</m:mo></m:mrow></m:mrow></m:msup></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:munder><m:munder accentunder="true"><m:mrow><m:mspace width="0.166667em"/><m:mtable frame="solid"><m:mtr><m:mtd><m:mstyle scriptlevel="0" displaystyle="false"><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>n</m:mi><m:mo>-</m:mo><m:mfrac><m:mrow><m:mi>M</m:mi><m:mo>+</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub></m:mstyle></m:mtd></m:mtr></m:mtable><m:mspace width="0.166667em"/></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>impulse</m:mtext><m:mspace width="4.pt"/><m:mtext>response</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:munder><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Repeating this procedure for <m:math overflow="scroll"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> yields
<equation id="uid74"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:munder><m:munder accentunder="true"><m:mrow><m:mspace width="0.166667em"/><m:mtable frame="solid"><m:mtr><m:mtd><m:mstyle scriptlevel="0" displaystyle="false"><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>n</m:mi><m:mo>-</m:mo><m:mfrac><m:mrow><m:mi>M</m:mi><m:mo>-</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub></m:mstyle></m:mtd></m:mtr></m:mtable><m:mspace width="0.166667em"/></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>impulse</m:mtext><m:mspace width="4.pt"/><m:mtext>response</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:munder><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
At this point we make a few comments on the design of the lowpass
prototype <m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math>.
The perfect <m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math> would be an ideal linear-phase lowpass filter with
cutoff at <m:math overflow="scroll"><m:mrow><m:mi>ω</m:mi><m:mo>=</m:mo><m:mi>π</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:math>, as illustrated in <link target-id="uid75"/>.
Such a filter would perfectly separate the subbands as well as yield
flat composite magnitude response, as per <link target-id="uid70"/>.
Unfortunately, however, this perfect filter is not realizable with a
finite number of filter coefficients.
So, what we really want is a finite-length FIR filter having good
frequency selectivity, nearly-flat composite response, and linear phase.
The length-512 prototype filter specified in the MPEG standards is
such a filter, as evidenced by the responses in <link target-id="uid76"/>.
Unfortunately, the standards do not describe how this filter was designed,
and a thorough discussion of multirate filter design is outside the
scope of this course. For more on prototype filter design, we point the interested reader to page 358 of Vaidyanathan or Crochiere &amp; Rabiner. 
<figure id="uid75"><media id="uid75_media" alt="This figure is a graph with horizontal axis ω, ranging in value from -π to π, and vertical axis |H(π)|. There is one dashed rectangle with its base sitting on the horizontal axis, and  with its width measured from horizontal position -π/2N to π/2N. The height is not measured or labeled. There is also a solid curve that, in a calmly wavelike distortion follows the horizontal axis to the bottom-left vertex of the rectangle. The curve then sharply increases to follow the boundary of the dashed rectangle, until at the bottom-right vertex it flattens to continue following the horizontal axis to the edge of the graph."><image mime-type="image/png" src="../../media/img037.png" id="uid75_onlineimage" width="391"><!-- NOTE: attribute width changes image size online (pixels). original width is 391. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img037.eps" id="uid75_printimage"/></media><caption>Ideal (dashed) and typical (solid) prototype-filter magnitude responses for the cosine-modulated filterbank. Note bandwidth relative to <link target-id="uid38"/>.</caption></figure><figure id="uid76"><media id="uid76_media" alt="This figure is comprised of two cartesian graphs. Both graphs show waves plotted with radians on the horizontal axis and magnitude [dB] on the vertical axis. The first graph is titled prototype filter. The vertical values on this graph range from -120 to 20, and the horizontal values from 0 to 3. The graph begins at nearly a vertical value of 20, immediately falling into a series of nonuniform waves of varying amplitudes and wavelengths in no distinct pattern. There are perhaps one hundred of these waves, never reaching a vertical value again higher than -80, and continuing to the right side of the graph. The second graph is titled composite system. The vertical values range from -2 x 10^-4 to 8 x 10^-4. The horizontal values range from 0 to 3. The waves in this graph follow a rigid, predictable pattern. They have extremely short wavelengths and there are perhaps 150 waves occurring across the page. The waves are centered around a vertical value of 3, and follow a repeating amplitude pattern of 3.2, 3.1, 3.1, 3.2, 2.5."><image mime-type="image/png" src="../../media/img038.png" id="uid76_onlineimage" width="477"><!-- NOTE: attribute width changes image size online (pixels). original width is 477. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img038.eps" id="uid76_printimage"/></media><caption>Magnitude response of <m:math overflow="scroll"><m:mrow><m:mo>|</m:mo><m:mi>H</m:mi><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo><m:mo>|</m:mo></m:mrow></m:math> of MPEG prototype filter and the resulting composite response <m:math overflow="scroll"><m:mrow><m:mo>|</m:mo><m:mi>Q</m:mi><m:mo>(</m:mo><m:mi>ω</m:mi><m:mo>)</m:mo><m:mo>|</m:mo></m:mrow></m:math>, where <m:math overflow="scroll"><m:mrow><m:mi>N</m:mi><m:mo>=</m:mo><m:mn>32</m:mn></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>=</m:mo><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>=</m:mo><m:mn>512</m:mn></m:mrow></m:math>.</caption></figure>
To conclude, <link target-id="uid73"/> (fourth equation) and <link target-id="uid74"/> give impulse response expressions
for a set of real-valued filters that comprise a near-perfectly
reconstructing filterbank (under suitable selection of <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>h</m:mi><m:mi>i</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math>).
This is commonly referred to<footnote id="uid77">The MPEG standards refer to this filterbank as a “polyphase
quadrature” filterbank (PQF), the name given to the technique by
an early technical paper: Rothweiler ICASSP 83</footnote> as a “cosine-modulated filterbank” because
all filters are based on cosine modulations of a
real-valued linear-phase lowpass prototype <m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math>.
The near-perfect reconstruction property follows from the frequency-domain
cancellation of adjacent-spectrum aliasing and the lack of phase distortion.
<newline/>
It should be noted that our derivation of the cosine modulated filterbank
is similar to that in Rothweiler ICASSP 83 except for the treatments
of phase distortion.
See Chapter 8 of Vaidyanathan for a more comprehensive
view of cosine-modulated filterbanks.
</item>
            <item id="uid78"><emphasis effect="italics"><emphasis effect="underline">Polyphase Implementations:</emphasis></emphasis> 
Recall the uniformly modulated filterbank in
<link document="m32143" target-id="uid40">Figure 4 from "Uniformly-Modulated Filterbanks"</link>, whose combined modulator-filter coefficients
can be constructed using products of the terms <m:math overflow="scroll"><m:mstyle scriptlevel="0" displaystyle="false"><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub></m:mstyle></m:math> and
<m:math overflow="scroll"><m:msup><m:mi>e</m:mi><m:mrow><m:mi>j</m:mi><m:mfrac><m:mi>π</m:mi><m:mi>N</m:mi></m:mfrac><m:mi>i</m:mi><m:mi>n</m:mi></m:mrow></m:msup></m:math>.
<link document="m32143" target-id="uid45">Figure 5 from "Uniformly-Modulated Filterbanks"</link> shows a computationally-efficient polyphase/DFT
implementation of the analysis filter which requires only <emphasis effect="italics">M</emphasis> multiplies
and one <emphasis effect="italics">N</emphasis>-dimensional DFT computation for calculation of <emphasis effect="italics">N</emphasis> subband
outputs.
We might wonder: Is there a similar polyphase/fast-transform
implementation of the cosine-modulated filterbank derived in
this section?
From <link target-id="uid73"/> (fourth equation), we see that the impulse responses of <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>
are products of the terms <m:math overflow="scroll"><m:mstyle scriptlevel="0" displaystyle="false"><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub></m:mstyle></m:math> and
<m:math overflow="scroll"><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>n</m:mi><m:mo>-</m:mo><m:mfrac><m:mrow><m:mi>M</m:mi><m:mo>+</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced></m:mrow></m:math>
for <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>.
Note that the inverse-DCT matrix <emphasis effect="italics">C<sub>n</sub><sup>t</sup></emphasis> can be specified via
components with form similar to the cosine term in <link target-id="uid73"/> (fourth equation):
<equation id="id2694021"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:msub><m:mfenced open="[" close="]"><m:msubsup><m:mi mathvariant="bold">C</m:mi><m:mi>N</m:mi><m:mi>t</m:mi></m:msubsup></m:mfenced><m:mrow><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>n</m:mi></m:mrow></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:msqrt><m:mfrac><m:mn>2</m:mn><m:mi>N</m:mi></m:mfrac></m:msqrt><m:mspace width="0.166667em"/><m:msub><m:mi>α</m:mi><m:mi>n</m:mi></m:msub><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>n</m:mi></m:mfenced><m:mo>;</m:mo><m:mspace width="1.em"/><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>⋯</m:mo><m:mi>N</m:mi><m:mspace width="-0.166667em"/><m:mo>-</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd columnalign="left"><m:mrow><m:mtext>for</m:mtext><m:mspace width="3.33333pt"/><m:mspace width="3.33333pt"/><m:msub><m:mi>α</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:msqrt><m:mn>2</m:mn></m:msqrt><m:mo>,</m:mo><m:mspace width="3.33333pt"/><m:mspace width="3.33333pt"/><m:msub><m:mi>α</m:mi><m:mrow><m:mi>n</m:mi><m:mo>≠</m:mo><m:mn>0</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Thus it may not be surprising that there exist polyphase/DCT
implementations of the cosine-modulated filterbank.
Indeed, one such implementation is specified in the MPEG-2 audio
compression standard (see ISO/IEC 13818-3).
This particular implementation is the focus of the next section.
</item>
          </list>
        </section>
        <section id="uid79">
          <title>MPEG Filterbank Implementation</title>
          <list id="id2694253" display="block" list-type="bulleted"><item id="uid80">Since MPEG audio compression standards are so well-known and widespread,
a detailed look at the MPEG filterbank implementation is warranted.
The cosine-modulated, or polyphase-quadrature filterbank described
in the previous section is used in MPEG Layers 1-3.
(The MPEG hierarchy will be described in a later chapter.)
This section discusses the specific implementation suggested by the
MPEG-2 standard (see ISO/IEC 13818-3).
</item>
            <item id="uid81">The MPEG standard specifies 512 prototype filter coefficients, the
first of which is zero.
To adapt the MPEG filter to our cosine-modulated-filterbank framework,
we append a zero-valued 513<sup>th</sup> coefficient so that the resulting
MPEG prototype filter becomes symmetric and hence linear phase.
Since the standard specifies <m:math overflow="scroll"><m:mrow><m:mi>N</m:mi><m:mo>=</m:mo><m:mn>32</m:mn></m:mrow></m:math> frequency bands, we have
<equation id="id2694319"><m:math overflow="scroll" mode="display"><m:mrow><m:mi>M</m:mi><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mn>513</m:mn><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>.</m:mo></m:mrow></m:math></equation>
Plugging this value of <emphasis effect="italics">M</emphasis> into the filter expressions
<link target-id="uid73"/> (fourth equation) and <link target-id="uid74"/>, the <m:math overflow="scroll"><m:mrow><m:mn>2</m:mn><m:mi>π</m:mi></m:mrow></m:math>-periodicity of the cosine
implies that they may be rewritten as follows.
<equation id="id2694399"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:munder><m:munder accentunder="true"><m:mrow><m:mspace width="0.166667em"/><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>n</m:mi><m:mo>-</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:mstyle><m:mspace width="0.166667em"/></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>impulse</m:mtext><m:mspace width="4.pt"/><m:mtext>response</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mrow><m:msub><m:mi>H</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:munder><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:munder><m:munder accentunder="true"><m:mrow><m:mspace width="0.166667em"/><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>n</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:mstyle><m:mspace width="0.166667em"/></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>impulse</m:mtext><m:mspace width="4.pt"/><m:mtext>response</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mrow><m:msub><m:mi>K</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mrow></m:munder><m:msup><m:mi>z</m:mi><m:mrow><m:mo>-</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation></item>
            <item id="uid82"><emphasis effect="italics"><emphasis effect="underline">Encoding:</emphasis></emphasis> 
Here we derive the encoder filterbank implementation suggested in the
MPEG-2 standard (see ISO/IEC 13818-3).
Using <m:math overflow="scroll"><m:mrow><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> to denote the output of the <m:math overflow="scroll"><m:msup><m:mi>i</m:mi><m:mrow><m:mi>t</m:mi><m:mi>h</m:mi></m:mrow></m:msup></m:math> analysis filter,
we have
<equation id="id2694840"><m:math overflow="scroll" mode="display"><m:mrow><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="[" close=")"><m:mstyle scriptlevel="0" displaystyle="false"><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mo>(</m:mo><m:mi>k</m:mi><m:mo>-</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mstyle></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>k</m:mi></m:msub><m:mo>]</m:mo><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>-</m:mo><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:math></equation>
The relationship between <m:math overflow="scroll"><m:mrow><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> and its downsampled version <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
is given by
<equation id="id2695034"><m:math overflow="scroll" mode="display"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math></equation>
so that the downsampled analysis output <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> can be written as
<equation id="id2695109"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="[" close=")"><m:mstyle scriptlevel="0" displaystyle="false"><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>-</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mstyle></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>n</m:mi></m:msub><m:mo>]</m:mo><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>-</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Using the substitution <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mi>k</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>ℓ</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mspace width="-0.166667em"/><m:mo>-</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow></m:math>,
<equation id="id2695316"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mn>2</m:mn><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mn>15</m:mn></m:munderover><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>ℓ</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:munder><m:munder accentunder="true"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>k</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>-</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced></m:mrow></m:mstyle><m:mo>︸</m:mo></m:munder><m:mtable><m:mtr><m:mtd><m:mstyle scriptlevel="1" displaystyle="false"><m:mrow><m:mtext>repeats</m:mtext><m:mspace width="4.pt"/><m:mtext>every</m:mtext><m:mspace width="4.pt"/><m:mn>4</m:mn><m:mspace width="4.pt"/><m:mtext>increments</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mi>k</m:mi></m:mrow></m:mstyle></m:mtd></m:mtr><m:mtr><m:mtd><m:mstyle scriptlevel="1" displaystyle="false"><m:mrow><m:mtext>sign</m:mtext><m:mspace width="4.pt"/><m:mtext>changes</m:mtext><m:mspace width="4.pt"/><m:mtext>every</m:mtext><m:mspace width="4.pt"/><m:mn>2</m:mn><m:mspace width="4.pt"/><m:mtext>increments</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mi>k</m:mi></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:munder><m:msub><m:mi>h</m:mi><m:mrow><m:mi>k</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:msub><m:mspace width="0.277778em"/><m:mi>x</m:mi><m:mfenced separators="" open="(" close=")"><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>k</m:mi><m:mo>)</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mi>ℓ</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mn>15</m:mn></m:munderover><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>ℓ</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:munder><m:munder accentunder="true"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:msub><m:mrow><m:mo>〈</m:mo><m:mi>k</m:mi><m:mo>〉</m:mo></m:mrow><m:mn>2</m:mn></m:msub><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>-</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced></m:mrow></m:mstyle><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>repeats</m:mtext><m:mspace width="4.pt"/><m:mtext>every</m:mtext><m:mspace width="4.pt"/><m:mn>2</m:mn><m:mspace width="4.pt"/><m:mtext>increments</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mi>k</m:mi></m:mrow></m:munder><m:mspace width="0.277778em"/><m:munder><m:munder accentunder="true"><m:mrow><m:mn>2</m:mn><m:mspace width="0.166667em"/><m:msup><m:mrow><m:mo>(</m:mo><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>⌊</m:mo><m:mi>k</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>⌋</m:mo></m:mrow></m:msup><m:msub><m:mi>h</m:mi><m:mrow><m:mi>k</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:msub></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>analysis</m:mtext><m:mspace width="4.pt"/><m:mtext>window</m:mtext></m:mrow></m:munder><m:mspace width="0.277778em"/><m:mi>x</m:mi><m:mfenced separators="" open="(" close=")"><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>k</m:mi><m:mo>)</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mi>ℓ</m:mi></m:mfenced></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
<link target-id="uid83"/> illustrates this process.
<figure id="uid83"><media id="uid83_media" alt="This is a complex flowchart with general downward movement of a number of rows of labeled, connected rectangles, all pointing down at a row of circles containing plus signs, which point down at a large box titled cosine matrix transformation. The columns of these connected rectangles are labeled across from k = 0 to k = 16. The first row of  boxes contain labels across from x(mN),... to x(m-16)N +1. The first set of arrows pointing down to the next set of rectangles are all labeled with a * sign. The second row of boxes are labeled across from h_0, ..., h_N-1 to h_15N, ... , h_16N-1. This is followed by another set of arrows with asterisks. The next row of  rectangles contain a series of the number 2 or the number -2. Below this are arrows labeled =. Below these arrows are more boxes that contain 13 hash marks inside. From different hash marks are longer arrows that point at the different circles containing plus signs, which in turn all point at the large cosine matrix transformation box. The positions at which these circles point at the box are labeled across from j = 0 to j = 2N-1. On the right side of the box are a series of equations from top to bottom, i = 0 to i = N - 1. To the right of each of these equations is an arrow pointing to the right at the variables from top to bottom s_0(m) to s_N-1(m)."><image mime-type="image/png" src="../../media/img039.png" id="uid83_onlineimage" width="754"><!-- NOTE: attribute width changes image size online (pixels). original width is 754. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img039.eps" id="uid83_printimage"/></media><caption>MPEG encoder filterbank implementation suggested in ISO/IEC 13818-3.</caption></figure></item>
            <item id="uid84"><emphasis effect="italics"><emphasis effect="underline">Decoding:</emphasis></emphasis> 
Here we derive the dencoder filterbank implementation suggested in the
MPEG-2 standard (see ISO/IEC 13818-3).
Using <m:math overflow="scroll"><m:mrow><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> to denote the output of the <m:math overflow="scroll"><m:msup><m:mi>i</m:mi><m:mrow><m:mi>t</m:mi><m:mi>h</m:mi></m:mrow></m:msup></m:math> upsampler,
<equation id="id2695970"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mfenced separators="" open="[" close="]"><m:mstyle scriptlevel="0" displaystyle="false"><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>k</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>k</m:mi></m:msub></m:mstyle></m:mfenced><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>-</m:mo><m:mi>k</m:mi><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
The input to the upsampler <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is related to the output <m:math overflow="scroll"><m:mrow><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> by
<equation id="id2696178"><m:math overflow="scroll" mode="display"><m:mrow><m:msub><m:mi>y</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mfenced separators="" open="{" close=""><m:mtable><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>/</m:mo><m:mi>N</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mtext>when</m:mtext><m:mspace width="3.33333pt"/><m:mi>n</m:mi><m:mo>/</m:mo><m:mi>N</m:mi><m:mo>∈</m:mo><m:mi mathvariant="double-struck">Z</m:mi></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="left"><m:mrow><m:mtext>else</m:mtext><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mfenced></m:mrow></m:math></equation>
so that
<equation id="id2696289"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:munder>
<m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mo>{</m:mo><m:mi>k</m:mi><m:mo>:</m:mo><m:mfrac><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mi>k</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mo>∈</m:mo><m:mi mathvariant="double-struck">Z</m:mi><m:mo>}</m:mo></m:mrow></m:munder><m:mfenced separators="" open="[" close="]"><m:mstyle scriptlevel="0" displaystyle="false"><m:mn>2</m:mn><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>k</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mi>k</m:mi></m:msub></m:mstyle></m:mfenced><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mfenced open="(" close=")"><m:mfrac><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mi>k</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac></m:mfenced><m:mo>.</m:mo></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:math></equation>
Lets write <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>ℓ</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mspace width="-0.166667em"/><m:mo>-</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow></m:math> and
<m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>q</m:mi></m:mrow></m:math> for <m:math overflow="scroll"><m:mrow><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>q</m:mi><m:mo>≤</m:mo><m:mi>N</m:mi><m:mspace width="-0.166667em"/><m:mo>-</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn></m:mrow></m:math>.
Then due to the restricted ranges of <emphasis effect="italics">ℓ</emphasis> and <emphasis effect="italics">q</emphasis>,
<equation id="id2696594"><m:math overflow="scroll" mode="display"><m:mrow><m:mfrac><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mi>k</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>p</m:mi><m:mo>+</m:mo><m:mfrac><m:mrow><m:mi>ℓ</m:mi><m:mo>-</m:mo><m:mi>q</m:mi></m:mrow><m:mi>N</m:mi></m:mfrac><m:mspace width="3.33333pt"/><m:mo>∈</m:mo><m:mspace width="3.33333pt"/><m:mi mathvariant="double-struck">Z</m:mi><m:mspace width="1.em"/><m:mo>⇒</m:mo><m:mspace width="1.em"/><m:mi>ℓ</m:mi><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mi>q</m:mi><m:mo>.</m:mo></m:mrow></m:math></equation>
Using these substitutions in the previous equation for <m:math overflow="scroll"><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>n</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>,
<equation id="id2696712"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:mn>2</m:mn><m:munderover>
<m:mrow>
<m:mo>∑</m:mo>
</m:mrow><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mn>15</m:mn></m:munderover><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>h</m:mi><m:mrow><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:msub><m:mspace width="0.222222em"/><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>p</m:mi><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:math></equation>
Summing <m:math overflow="scroll"><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> over <emphasis effect="italics">i</emphasis> to create <m:math overflow="scroll"><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>)</m:mo></m:mrow></m:math>,
<equation id="id2696945"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>)</m:mo></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:mn>2</m:mn><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mn>15</m:mn></m:munderover><m:munder><m:munder accentunder="true"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:mstyle><m:mo>︸</m:mo></m:munder><m:mtable><m:mtr><m:mtd><m:mstyle scriptlevel="1" displaystyle="false"><m:mrow><m:mtext>repeats</m:mtext><m:mspace width="4.pt"/><m:mtext>every</m:mtext><m:mspace width="4.pt"/><m:mn>4</m:mn><m:mspace width="4.pt"/><m:mtext>increments</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mi>p</m:mi></m:mrow></m:mstyle></m:mtd></m:mtr><m:mtr><m:mtd><m:mstyle scriptlevel="1" displaystyle="false"><m:mrow><m:mtext>sign</m:mtext><m:mspace width="4.pt"/><m:mtext>changes</m:mtext><m:mspace width="4.pt"/><m:mtext>every</m:mtext><m:mspace width="4.pt"/><m:mn>2</m:mn><m:mspace width="4.pt"/><m:mtext>increments</m:mtext><m:mspace width="4.pt"/><m:mtext>of</m:mtext><m:mspace width="4.pt"/><m:mi>p</m:mi></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:munder><m:msub><m:mi>h</m:mi><m:mrow><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:msub><m:mspace width="0.222222em"/><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>p</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mrow><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mn>15</m:mn></m:munderover><m:munder><m:munder accentunder="true"><m:mrow><m:mn>2</m:mn><m:mspace width="0.166667em"/><m:msup><m:mrow><m:mo>(</m:mo><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>⌊</m:mo><m:mi>p</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>⌋</m:mo></m:mrow></m:msup><m:msub><m:mi>h</m:mi><m:mrow><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:msub></m:mrow><m:mo>︸</m:mo></m:munder><m:mrow><m:mtext>synthesis</m:mtext><m:mspace width="4.pt"/><m:mtext>window</m:mtext></m:mrow></m:munder><m:mspace width="5.69054pt"/><m:munderover><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mspace width="-8.53581pt"/><m:munder><m:munder accentunder="true"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:msub><m:mrow><m:mo>〈</m:mo><m:mi>p</m:mi><m:mo>〉</m:mo></m:mrow><m:mn>2</m:mn></m:msub><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:mstyle><m:mo>︸</m:mo></m:munder><m:mrow><m:mo>=</m:mo><m:mfenced separators="" open="{" close=""><m:mtable><m:mtr><m:mtd columnalign="left"><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>ℓ</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>p</m:mi><m:mspace width="4.pt"/><m:mtext>even</m:mtext></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mrow><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>ℓ</m:mi><m:mo>+</m:mo><m:mi>N</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>p</m:mi><m:mspace width="4.pt"/><m:mtext>odd</m:mtext></m:mrow></m:mtd></m:mtr></m:mtable></m:mfenced></m:mrow></m:munder><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>p</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
If we define
<equation id="id2697606"><m:math overflow="scroll" mode="display"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:msub><m:mi>v</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>j</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="1.em"/><m:mtext>for</m:mtext><m:mspace width="1.em"/><m:mn>0</m:mn><m:mo>≤</m:mo><m:mi>j</m:mi><m:mo>≤</m:mo><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mstyle></m:math></equation>
(note the range of <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mspace width="0.166667em"/></m:mrow></m:math>!) then we can rewrite
<equation id="id2697780"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:mi>u</m:mi><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:munder><m:mo>∑</m:mo><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>14</m:mn></m:mrow></m:munder><m:msup><m:mrow><m:mo>(</m:mo><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>⌊</m:mo><m:mi>p</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>⌋</m:mo></m:mrow></m:msup><m:msub><m:mi>h</m:mi><m:mrow><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:msub><m:mspace width="0.222222em"/><m:msub><m:mi>v</m:mi><m:mi>ℓ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>p</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="8.53581pt"/><m:mo>+</m:mo><m:mspace width="-2.84526pt"/><m:munder><m:mo>∑</m:mo><m:mrow><m:mi>p</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>3</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>15</m:mn></m:mrow></m:munder><m:msup><m:mrow><m:mo>(</m:mo><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>⌊</m:mo><m:mi>p</m:mi><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>⌋</m:mo></m:mrow></m:msup><m:msub><m:mi>h</m:mi><m:mrow><m:mi>p</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi></m:mrow></m:msub><m:mspace width="0.222222em"/><m:msub><m:mi>v</m:mi><m:mrow><m:mi>ℓ</m:mi><m:mo>+</m:mo><m:mi>N</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mi>p</m:mi><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
<link target-id="uid85"/> illustrates the construction of <m:math overflow="scroll"><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>m</m:mi><m:mi>N</m:mi><m:mo>+</m:mo><m:mi>ℓ</m:mi><m:mo>)</m:mo></m:mrow></m:math>
using the notation
<equation id="id2698045"><m:math overflow="scroll" mode="display"><m:mrow><m:mi mathvariant="bold">v</m:mi><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>=</m:mo><m:mfenced open="(" close=")"><m:mtable><m:mtr><m:mtd><m:mrow><m:msub><m:mi>v</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>⋯</m:mo></m:mtd><m:mtd><m:mrow><m:msub><m:mi>v</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd></m:mtr></m:mtable></m:mfenced><m:mo>.</m:mo></m:mrow></m:math></equation><figure id="uid85"><media id="uid85_media" alt="This is another complex flowchart that generally moves in the reverse direction of the encoder flowchart in figure 25. The chart begins with the large cosine matrix transformation box, containing the same labels, then points down at a row of connected boxes labeled from v(m) to v(m - 15). Below these boxes are a series of shaded, but unlabeled boxes. Below these are the arrows with asterisks, which point at boxes  containing the h_subscript labels. Below these are more asterisk arrows, which point at the boxes with the series of 2's or -2's. Below these are the equal sign arrows which point down at the boxes with the hash marks. From the hash marks are arrows that point at each circle containing a plus sign, and from each circle there is an arrow pointing down at a final single rectangle containing six hash marks (8 including the sides of the rectangle) numbered from 0 to N."><image mime-type="image/png" src="../../media/img040.png" id="uid85_onlineimage" width="641"><!-- NOTE: attribute width changes image size online (pixels). original width is 641. --></image><image for="pdf" mime-type="application/postscript" src="../../media/img040.eps" id="uid85_printimage"/></media><caption>MPEG decoder filterbank implementation suggested in ISO/IEC 13818-3.</caption></figure></item>
            <item id="uid86"><emphasis effect="italics"><emphasis effect="underline">DCT Implementation of Cosine Matrixing:</emphasis></emphasis> 
As seen in <link target-id="uid83"/> and <link target-id="uid85"/>,
the filterbank implementations suggested by the MPEG standard require
a cosine matrix operation that, if implemented using straightforward
arithmetic, requires <m:math overflow="scroll"><m:mrow><m:mn>32</m:mn><m:mo>×</m:mo><m:mn>64</m:mn><m:mo>=</m:mo><m:mn>2048</m:mn></m:mrow></m:math> multiply/adds at both
the encoder and decoder.
Note, however, that the cosine transformations in <link target-id="uid83"/>
and <link target-id="uid85"/> do bear a great deal of similarity to the DCT:

<equation id="uid87"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:msub><m:mi>y</m:mi><m:mi>k</m:mi></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:msqrt><m:mfrac><m:mn>2</m:mn><m:mi>N</m:mi></m:mfrac></m:msqrt><m:mspace width="0.166667em"/><m:msub><m:mi>α</m:mi><m:mi>k</m:mi></m:msub><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>k</m:mi></m:mfenced><m:mo>;</m:mo><m:mspace width="1.em"/><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>⋯</m:mo><m:mi>N</m:mi><m:mspace width="-0.166667em"/><m:mo>-</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mstyle></m:mtd></m:mtr><m:mtr><m:mtd/><m:mtd/><m:mtd columnalign="left"><m:mrow><m:mtext>for</m:mtext><m:mspace width="3.33333pt"/><m:mspace width="3.33333pt"/><m:msub><m:mi>α</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:msqrt><m:mn>2</m:mn></m:msqrt><m:mo>,</m:mo><m:mspace width="3.33333pt"/><m:mspace width="3.33333pt"/><m:msub><m:mi>α</m:mi><m:mrow><m:mi>k</m:mi><m:mo>≠</m:mo><m:mn>0</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="right"><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:msqrt><m:mfrac><m:mn>2</m:mn><m:mi>N</m:mi></m:mfrac></m:msqrt><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:msub><m:mi>α</m:mi><m:mi>k</m:mi></m:msub><m:mspace width="0.166667em"/><m:msub><m:mi>y</m:mi><m:mi>k</m:mi></m:msub><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>k</m:mi></m:mfenced><m:mo>;</m:mo><m:mspace width="1.em"/><m:mi>n</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>⋯</m:mo><m:mi>N</m:mi><m:mspace width="-0.166667em"/><m:mo>-</m:mo><m:mspace width="-0.166667em"/><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:math></equation>
which we know has a fast algorithm:
Lee's <m:math overflow="scroll"><m:mrow><m:mn>32</m:mn><m:mo>×</m:mo><m:mn>32</m:mn></m:mrow></m:math> fast-DCT, for example, requires only 80
multiplications and 209 additions (see B.G.Lee TASSP Dec 84).
So how do we implement the matrix operation using the fast-DCT?
A technique has been described clearly in Konstantinides SPL 1994,
the results of which are summarized below.
At the encoder, the matrix operation can be written
<equation id="id2698599"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>j</m:mi><m:mo>-</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>w</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="1.em"/><m:mtext>for</m:mtext><m:mspace width="1.em"/><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:math></equation>
where <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>w</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:msub><m:mi>w</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is created from
<m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:mi>x</m:mi><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mi>x</m:mi><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>-</m:mo><m:mn>16</m:mn><m:mi>N</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>}</m:mo></m:mrow></m:math> by windowing, shifting, and adding.
(See <link target-id="uid83"/>.)
We can write
<equation id="uid88"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>j</m:mi></m:mfenced><m:msub><m:mover accent="true"><m:mi>w</m:mi><m:mo>¯</m:mo></m:mover><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>;</m:mo><m:mspace width="1.em"/><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:math></equation>
where, for <m:math overflow="scroll"><m:mrow><m:mi>N</m:mi><m:mo>=</m:mo><m:mn>32</m:mn></m:mrow></m:math>, <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mover accent="true"><m:mi>w</m:mi><m:mo>¯</m:mo></m:mover><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> is the following manipulation
of <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>w</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>:
<equation id="id2699116"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mover accent="true"><m:mi>w</m:mi><m:mo>¯</m:mo></m:mover><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>:</m:mo><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mfenced separators="" open="{" close=""><m:mtable><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>w</m:mi><m:mn>16</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>w</m:mi><m:mrow><m:mn>16</m:mn><m:mo>+</m:mo><m:mi>j</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:msub><m:mi>w</m:mi><m:mrow><m:mn>16</m:mn><m:mo>-</m:mo><m:mi>j</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>16</m:mn></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mi>w</m:mi><m:mrow><m:mn>16</m:mn><m:mo>+</m:mo><m:mi>j</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>-</m:mo><m:msub><m:mi>w</m:mi><m:mrow><m:mn>80</m:mn><m:mo>-</m:mo><m:mi>j</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>17</m:mn><m:mo>,</m:mo><m:mn>18</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>31</m:mn><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mfenced></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Compare <link target-id="uid88"/> to the inverse DCT in <link target-id="uid87"/> (lower equation).
At the decoder, the matrix operation can be written
<equation id="id2699368"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>v</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mfenced separators="" open="(" close=")"><m:mi>j</m:mi><m:mo>+</m:mo><m:mfrac><m:mi>N</m:mi><m:mn>2</m:mn></m:mfrac></m:mfenced></m:mfenced><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="1.em"/><m:mtext>for</m:mtext><m:mspace width="1.em"/><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>,</m:mo></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:math></equation>
where <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>v</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:msub><m:mi>v</m:mi><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> are windowed, shifted,
and added to compute <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo><m:mo>}</m:mo></m:mrow></m:math>.
(See <link target-id="uid85"/>.) It is shown in Konstantinides SPL 1994 that,
for <m:math overflow="scroll"><m:mrow><m:mi>N</m:mi><m:mo>=</m:mo><m:mn>32</m:mn></m:mrow></m:math>,
<m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>v</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math> can be calculated by first computing <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mover accent="true"><m:mi>v</m:mi><m:mo>¯</m:mo></m:mover><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>:
<equation id="uid89"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mover accent="true"><m:mi>v</m:mi><m:mo>¯</m:mo></m:mover><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd><m:mo>=</m:mo></m:mtd><m:mtd columnalign="left"><m:mstyle scriptlevel="0" displaystyle="false"><m:mrow><m:munderover><m:mrow><m:mo>∑</m:mo></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mrow><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:munderover><m:mo form="prefix">cos</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>π</m:mi><m:mfrac><m:mrow><m:mn>2</m:mn><m:mi>i</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mn>2</m:mn><m:mi>N</m:mi></m:mrow></m:mfrac><m:mi>j</m:mi></m:mfenced><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mo>;</m:mo><m:mspace width="1.em"/><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mi>N</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:mstyle></m:mtd></m:mtr></m:mtable></m:math></equation>
and rearranging the outputs according to
<equation id="id2699859"><m:math overflow="scroll" mode="display"><m:mtable displaystyle="true"><m:mtr><m:mtd columnalign="right"><m:mrow><m:msub><m:mi>v</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="3.33333pt"/><m:mo>:</m:mo><m:mo>=</m:mo><m:mspace width="3.33333pt"/><m:mfenced separators="" open="{" close=""><m:mtable><m:mtr><m:mtd columnalign="left"><m:mrow><m:msub><m:mover accent="true"><m:mi>v</m:mi><m:mo>¯</m:mo></m:mover><m:mrow><m:mi>j</m:mi><m:mo>+</m:mo><m:mn>16</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>15</m:mn><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mn>0</m:mn></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>16</m:mn><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mrow><m:mo>-</m:mo><m:msub><m:mover accent="true"><m:mi>v</m:mi><m:mo>¯</m:mo></m:mover><m:mrow><m:mn>48</m:mn><m:mo>-</m:mo><m:mi>j</m:mi></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>17</m:mn><m:mo>,</m:mo><m:mn>18</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>47</m:mn><m:mo>,</m:mo></m:mrow></m:mtd></m:mtr><m:mtr><m:mtd columnalign="left"><m:mrow><m:mo>-</m:mo><m:msub><m:mover accent="true"><m:mi>v</m:mi><m:mo>¯</m:mo></m:mover><m:mrow><m:mi>j</m:mi><m:mo>-</m:mo><m:mn>48</m:mn></m:mrow></m:msub><m:mrow><m:mo>(</m:mo><m:mi>m</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:mtd><m:mtd columnalign="left"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>48</m:mn><m:mo>,</m:mo><m:mn>49</m:mn><m:mo>,</m:mo><m:mo>⋯</m:mo><m:mo>,</m:mo><m:mn>63</m:mn><m:mo>.</m:mo></m:mrow></m:mtd></m:mtr></m:mtable></m:mfenced></m:mrow></m:mtd></m:mtr></m:mtable></m:math></equation>
Compare <link target-id="uid89"/> to the DCT in <link target-id="uid87"/> (upper equation).
</item>
          </list>
        </section>
    







</content>

</document>